<div class="container">
  <!-- Header -->
  <div class="header">
    <h1>Banana AI Assistant</h1>
    <p>‡∏î‡∏∂‡∏á‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏à‡∏≤‡∏Å Azure DevOps</p>
  </div>

  <!-- User Card -->
  <div class="user-card">
    <div class="user-avatar">
      {{ user?.logged_in ? (user?.name?.charAt(0) || '?') : '?' }}
    </div>
    <div class="user-info">
      <h3>{{ user?.logged_in ? user?.name : '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö' }}</h3>
      <p>{{ user?.logged_in ? user?.email : '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡πâ‡∏ß‡∏¢ Microsoft' }}</p>
    </div>
    <button *ngIf="user?.logged_in" class="logout-btn" (click)="logout()">
      ‡∏≠‡∏≠‡∏Å
    </button>
  </div>

  <!-- Action Section -->
  <div class="action-section">
    <!-- Login Button - Direct href, no JavaScript -->
    <a *ngIf="!user?.logged_in" class="login-btn" href="/auth/microsoft">
      üîê ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡πâ‡∏ß‡∏¢ Microsoft
    </a>

    <!-- Fetch Button -->
    <button *ngIf="user?.logged_in" class="action-btn" (click)="fetchTasks()" [disabled]="isLoading">
      <span *ngIf="isLoading">‚è≥</span>
      <span>üìã ‡∏î‡∏∂‡∏á‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</span>
    </button>
  </div>

  <!-- Tabs for Results -->
  <div class="tabs" *ngIf="taskResponse && !isLoading">
    <button class="tab" [class.active]="activeTab === 'active'" (click)="activeTab = 'active'">
      üìä ‡∏á‡∏≤‡∏ô Active
    </button>
    <button class="tab" [class.active]="activeTab === 'pullreq'" (click)="activeTab = 'pullreq'">
      üîÄ Pull Requested
    </button>
    <button class="tab" [class.active]="activeTab === 'changes'" (click)="activeTab = 'changes'">
      üìÖ State Changes
    </button>
  </div>

  <!-- Result Section -->
  <div class="result-section">
    <div class="result-label">‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</div>
    
    <div class="result-content">
      <!-- Loading -->
      <div *ngIf="isLoading" class="placeholder">
        <div class="icon">‚è≥</div>
        <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</p>
      </div>

      <!-- Error -->
      <div *ngIf="error" class="placeholder error">
        <div class="icon">‚ùå</div>
        <p>{{ error }}</p>
      </div>

      <!-- Not logged in -->
      <div *ngIf="!user?.logged_in && !isLoading && !taskResponse" class="placeholder">
        <div class="icon">üîê</div>
        <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πà‡∏≠‡∏ô</p>
      </div>

      <!-- No tasks yet -->
      <div *ngIf="user?.logged_in && !isLoading && !taskResponse && !error" class="placeholder">
        <div class="icon">üìÇ</div>
        <p>‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏∂‡∏á‡∏á‡∏≤‡∏ô</p>
      </div>

      <!-- Task Content with Tabs -->
      <div *ngIf="taskResponse && !isLoading" class="task-content">
        <div [innerHTML]="getTabContent()"></div>
      </div>
    </div>
  </div>
</div>
